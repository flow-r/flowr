

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Styles &mdash; flowr 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="flowr 0.1 documentation" href="../../index.html"/>
        <link rel="up" title="Building Pipelines" href="../../build.html"/>
        <link rel="next" title="Help on available functions" href="../../topics.html"/>
        <link rel="prev" title="Building Pipelines" href="../../build.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../../index.html" class="icon icon-home"> flowr
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="quick-start.html">Get me started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quick-start.html#create-a-flow-using-example-data">Create a flow using example data</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick-start.html#ingredient-1-commands-to-run-flow-mat">Ingredient 1: Commands to run (flow_mat)</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick-start.html#ingredient-2-flow-definition-flow-def">Ingredient 2: Flow Definition (flow_def)</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick-start.html#plot-describing-the-definition">Plot describing the definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick-start.html#dry-run-submit">Dry run (submit)</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick-start.html#submit-to-the-cluster">Submit to the cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick-start.html#check-the-status">Check the status</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../run.html">HPCC Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pipelines.html">Available pipelines</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../build.html">Building Pipelines</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Styles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#style-1">Style 1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ingredient-1-flow-definition-format">Ingredient 1: Flow Definition format</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ingredient-2-flow-mat-a-table-with-all-the-commands-to-run">Ingredient 2: flow_mat: A table with all the commands to run:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#style-2">Style 2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submission-types">Submission types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dependency-types">Dependency types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#relationships">Relationships</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#serial-one-to-one-relationship">Serial: one to one relationship</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gather-many-to-one-relationship">Gather: many to one relationship</a></li>
<li class="toctree-l3"><a class="reference internal" href="#burst-one-to-many-relationship">Burst: one to many relationship</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hpcc-submission-formats">HPCC submission formats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../topics.html">Help on available functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../topics/flow.html">flow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../topics/flow.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/flow.html#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/flow.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../topics/get_flow_status.html">get_flow_status</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../topics/get_flow_status.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/get_flow_status.html#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/get_flow_status.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../topics/job.html">job</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../topics/job.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/job.html#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/job.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../topics/kill_flow.html">kill_flow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../topics/kill_flow.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/kill_flow.html#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/kill_flow.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../topics/plot_flow.html">plot_flow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../topics/plot_flow.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/plot_flow.html#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/plot_flow.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../topics/queue.html">queue</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../topics/queue.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/queue.html#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/queue.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../topics/rerun_flow.html">rerun_flow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../topics/rerun_flow.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/rerun_flow.html#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/rerun_flow.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../topics/setup.html">setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../topics/setup.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/setup.html#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/setup.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../topics/submit_flow.html">submit_flow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../topics/submit_flow.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/submit_flow.html#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/submit_flow.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../topics/submit_job.html">submit_job</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../topics/submit_job.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/submit_job.html#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/submit_job.html#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faqs.html">Some helpful tips and questions</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">flowr</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../build.html">Building Pipelines</a> &raquo;</li>
      
    <li>Styles</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/rd/vignettes/build-pipes.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="styles">
<h1>Styles<a class="headerlink" href="#styles" title="Permalink to this headline">¶</a></h1>
<div class="code r highlight-python"><div class="highlight"><pre><span class="n">exdata</span> <span class="o">=</span> <span class="nb">file</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="n">package</span> <span class="o">=</span> <span class="s">&quot;flowr&quot;</span><span class="p">),</span> <span class="s">&quot;extdata&quot;</span><span class="p">)</span>
<span class="n">flow_mat</span> <span class="o">=</span> <span class="n">read_sheet</span><span class="p">(</span><span class="nb">file</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="n">exdata</span><span class="p">,</span> <span class="s">&quot;example1_flow_mat.txt&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#&gt; Using &#39;samplename&#39;&#39; as id_column</span>
</pre></div>
</div>
<div class="code r highlight-python"><div class="highlight"><pre><span class="n">flow_def</span> <span class="o">=</span> <span class="n">read_sheet</span><span class="p">(</span><span class="nb">file</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="n">exdata</span><span class="p">,</span> <span class="s">&quot;example1_flow_def.txt&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#&gt; Using &#39;jobname&#39;&#39; as id_column</span>
</pre></div>
</div>
<div class="section" id="style-1">
<h2>Style 1<a class="headerlink" href="#style-1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ingredient-1-flow-definition-format">
<h3>Ingredient 1: Flow Definition format<a class="headerlink" href="#ingredient-1-flow-definition-format" title="Permalink to this headline">¶</a></h3>
<p>Each row of this table translate to a call to
(<a class="reference external" href="http://docs.flowr.space/build/html/rd/topics/job.html">job</a> or)
<a class="reference external" href="http://docs.flowr.space/build/html/rd/topics/queue.html">queue</a>
function.</p>
<ul class="simple">
<li>jobname: is passed as <code class="docutils literal"><span class="pre">name</span></code> argument to job().</li>
<li>prev_jobs: passed as <code class="docutils literal"><span class="pre">previous_job</span></code> argument to job().</li>
<li>dep_type: passed as <code class="docutils literal"><span class="pre">dependency_type</span></code> argument to job(). Possible
values: gather, serial</li>
<li>sub_type: passed as <code class="docutils literal"><span class="pre">submission_type</span></code> argument to job().</li>
<li>queue: name of the queue to be used for this particular job. Since
each jobs can be submitted to a different queue, this makes your flow
very flexible</li>
<li>memory_reserved: Refer to your system admin guide on what values
should go here. Some examples: 160000, 16g etc representing a 16GB
reservation of RAM</li>
<li>walltime: How long would this job run. Again refer to your HPCC
guide. Example: 24:00, 24:00:00</li>
<li>cpu_reserved: Amount of CPU reserved.</li>
</ul>
<p>Its best to have this as a tab seperated file (with no row.names).</p>
<div class="code r highlight-python"><div class="highlight"><pre><span class="n">kable</span><span class="p">(</span><span class="n">head</span><span class="p">(</span><span class="n">flow_def</span><span class="p">))</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
<col width="9%" />
<col width="18%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">jobname</th>
<th class="head">prev_jobs</th>
<th class="head">dep_type</th>
<th class="head">sub_type</th>
<th class="head">queue</th>
<th class="head">memory_reserved</th>
<th class="head">walltime</th>
<th class="head">cpu_reserved</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>sleep</td>
<td>none</td>
<td>none</td>
<td>scatter</td>
<td>medium</td>
<td>163185</td>
<td>23:00</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>tmp</td>
<td>sleep</td>
<td>serial</td>
<td>scatter</td>
<td>medium</td>
<td>163185</td>
<td>23:00</td>
<td>1</td>
</tr>
<tr class="row-even"><td>merge</td>
<td>tmp</td>
<td>gather</td>
<td>serial</td>
<td>medium</td>
<td>163185</td>
<td>23:00</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>size</td>
<td>merge</td>
<td>serial</td>
<td>serial</td>
<td>medium</td>
<td>163185</td>
<td>23:00</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="ingredient-2-flow-mat-a-table-with-all-the-commands-to-run">
<h3>Ingredient 2: flow_mat: A table with all the commands to run:<a class="headerlink" href="#ingredient-2-flow-mat-a-table-with-all-the-commands-to-run" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>samplename: The idea is to group commands based on this column and
submit individual flows for each sample<ul>
<li>This column is not really used in subsequent steps. So one can put
a dummy value like sample1, for all the rows if no subsetting is
desired</li>
</ul>
</li>
<li>jobname: This corresponds to the name of the job. This should match
perfectly with the jobname column in flow_def</li>
<li>cmd: the command to run</li>
</ul>
<p>Its best to have this as a tab seperated file (with no row.names)</p>
<div class="code r highlight-python"><div class="highlight"><pre><span class="n">kable</span><span class="p">(</span><span class="n">subset</span><span class="p">(</span><span class="n">flow_mat</span><span class="p">,</span> <span class="n">samplename</span> <span class="o">==</span> <span class="s">&quot;sample1&quot;</span><span class="p">))</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="9%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">samplename</th>
<th class="head">jobname</th>
<th class="head">cmd</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>sample1</td>
<td>sleep</td>
<td>sleep 17</td>
</tr>
<tr class="row-odd"><td>sample1</td>
<td>sleep</td>
<td>sleep 7</td>
</tr>
<tr class="row-even"><td>sample1</td>
<td>sleep</td>
<td>sleep 21</td>
</tr>
<tr class="row-odd"><td>sample1</td>
<td>sleep</td>
<td>sleep 1</td>
</tr>
<tr class="row-even"><td>sample1</td>
<td>sleep</td>
<td>sleep 4</td>
</tr>
<tr class="row-odd"><td>sample1</td>
<td>sleep</td>
<td>sleep 8</td>
</tr>
<tr class="row-even"><td>sample1</td>
<td>sleep</td>
<td>sleep 6</td>
</tr>
<tr class="row-odd"><td>sample1</td>
<td>sleep</td>
<td>sleep 11</td>
</tr>
<tr class="row-even"><td>sample1</td>
<td>sleep</td>
<td>sleep 12</td>
</tr>
<tr class="row-odd"><td>sample1</td>
<td>sleep</td>
<td>sleep 1</td>
</tr>
<tr class="row-even"><td>sample1</td>
<td>tmp</td>
<td>head -c 100000 /dev/urandom &gt; tmp1_1</td>
</tr>
<tr class="row-odd"><td>sample1</td>
<td>tmp</td>
<td>head -c 100000 /dev/urandom &gt; tmp1_2</td>
</tr>
<tr class="row-even"><td>sample1</td>
<td>tmp</td>
<td>head -c 100000 /dev/urandom &gt; tmp1_3</td>
</tr>
<tr class="row-odd"><td>sample1</td>
<td>tmp</td>
<td>head -c 100000 /dev/urandom &gt; tmp1_4</td>
</tr>
<tr class="row-even"><td>sample1</td>
<td>tmp</td>
<td>head -c 100000 /dev/urandom &gt; tmp1_5</td>
</tr>
<tr class="row-odd"><td>sample1</td>
<td>tmp</td>
<td>head -c 100000 /dev/urandom &gt; tmp1_6</td>
</tr>
<tr class="row-even"><td>sample1</td>
<td>tmp</td>
<td>head -c 100000 /dev/urandom &gt; tmp1_7</td>
</tr>
<tr class="row-odd"><td>sample1</td>
<td>tmp</td>
<td>head -c 100000 /dev/urandom &gt; tmp1_8</td>
</tr>
<tr class="row-even"><td>sample1</td>
<td>tmp</td>
<td>head -c 100000 /dev/urandom &gt; tmp1_9</td>
</tr>
<tr class="row-odd"><td>sample1</td>
<td>tmp</td>
<td>head -c 100000 /dev/urandom &gt; tmp1_10</td>
</tr>
<tr class="row-even"><td>sample1</td>
<td>merge</td>
<td>cat tmp1_1 tmp1_2 tmp1_3 tmp1_4 tmp1_5 tmp1_6 tmp1_7 tmp1_8 tmp1_9 tmp1_10 &gt; merge1</td>
</tr>
<tr class="row-odd"><td>sample1</td>
<td>size</td>
<td>du -sh merge1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="style-2">
<h2>Style 2<a class="headerlink" href="#style-2" title="Permalink to this headline">¶</a></h2>
<p>This style may be more suited for people who like to explore more
advanced usage and like to code in R. Also this one find this much
faster if jobs and their relationships changes a lot.</p>
<p>Here instead of seperating cmds and definitions one defines them step by
step incrementally.</p>
<ul class="simple">
<li>Use: queue(), to define the computing cluster being used</li>
<li>Use: multiple calls job()</li>
<li>Use: flow() to stich the jobs into a flow.</li>
</ul>
<p>Currently we support LSF, Torque and SGE. Let us use LSF for this
example.</p>
<div class="code r highlight-python"><div class="highlight"><pre><span class="n">qobj</span> <span class="o">&lt;-</span> <span class="n">queue</span><span class="p">(</span><span class="nb">type</span> <span class="o">=</span> <span class="s">&quot;lsf&quot;</span><span class="p">,</span> <span class="n">queue</span> <span class="o">=</span> <span class="s">&quot;normal&quot;</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">)</span>
</pre></div>
</div>
<p>Let us stitch a simple flow with three jobs, which are submitted one
after the other.</p>
<div class="code r highlight-python"><div class="highlight"><pre><span class="n">job1</span> <span class="o">&lt;-</span> <span class="n">job</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;myjob1&quot;</span><span class="p">,</span> <span class="n">cmds</span> <span class="o">=</span> <span class="s">&quot;sleep1&quot;</span><span class="p">,</span> <span class="n">q_obj</span> <span class="o">=</span> <span class="n">qobj</span><span class="p">)</span>
<span class="n">job2</span> <span class="o">&lt;-</span> <span class="n">job</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;myjob2&quot;</span><span class="p">,</span> <span class="n">cmds</span> <span class="o">=</span> <span class="s">&quot;sleep2&quot;</span><span class="p">,</span> <span class="n">q_obj</span> <span class="o">=</span> <span class="n">qobj</span><span class="p">,</span> <span class="n">previous_job</span> <span class="o">=</span> <span class="s">&quot;myjob1&quot;</span><span class="p">,</span> <span class="n">dependency_type</span> <span class="o">=</span> <span class="s">&quot;serial&quot;</span><span class="p">)</span>
<span class="n">job3</span> <span class="o">&lt;-</span> <span class="n">job</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;myjob3&quot;</span><span class="p">,</span> <span class="n">cmds</span> <span class="o">=</span> <span class="s">&quot;sleep3&quot;</span><span class="p">,</span> <span class="n">q_obj</span> <span class="o">=</span> <span class="n">qobj</span><span class="p">,</span> <span class="n">previous_job</span> <span class="o">=</span> <span class="s">&quot;myjob1&quot;</span><span class="p">,</span> <span class="n">dependency_type</span> <span class="o">=</span> <span class="s">&quot;serial&quot;</span><span class="p">)</span>
<span class="n">fobj</span> <span class="o">&lt;-</span> <span class="n">flow</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;myflow&quot;</span><span class="p">,</span> <span class="n">jobs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">job1</span><span class="p">,</span> <span class="n">job2</span><span class="p">,</span> <span class="n">job3</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s">&quot;description&quot;</span><span class="p">)</span>
<span class="n">plot_flow</span><span class="p">(</span><span class="n">fobj</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="" src="../../_images/plot_simpleflow-1.pdf" />
</div>
<p>The above translates to a flow definition which looks like this:</p>
<div class="code r highlight-python"><div class="highlight"><pre>dat &lt;- flowr:::.create_jobs_mat(fobj)
knitr:::kable(dat)
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="10%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
<col width="15%" />
<col width="8%" />
<col width="8%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&nbsp;</th>
<th class="head">jobname</th>
<th class="head">prev_jobs</th>
<th class="head">dep_type</th>
<th class="head">sub_type</th>
<th class="head">cpu_reserved</th>
<th class="head">nodes</th>
<th class="head">jobid</th>
<th class="head">prev_jobid</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>myjob1</td>
<td>myjob1</td>
<td>&nbsp;</td>
<td>none</td>
<td>scatter</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>NA</td>
</tr>
<tr class="row-odd"><td>myjob2</td>
<td>myjob2</td>
<td>myjob1</td>
<td>serial</td>
<td>scatter</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="row-even"><td>myjob3</td>
<td>myjob3</td>
<td>myjob1</td>
<td>serial</td>
<td>scatter</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="submission-types">
<h1>Submission types<a class="headerlink" href="#submission-types" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li>scatter: submit all commands as parallel independent jobs</li>
<li>serial: run these commands sequentuially one after the other</li>
</ul>
</div>
<div class="section" id="dependency-types">
<h1>Dependency types<a class="headerlink" href="#dependency-types" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li>none: independent job</li>
<li>serial: <em>one to one</em> relationship with previous job</li>
<li>gather: <em>many to one</em> wait for <strong>all</strong> commands in previous job to
finish then start current</li>
<li>burst: <em>one to many</em> wait for one jobs and start several when it
completes</li>
</ul>
</div>
<div class="section" id="relationships">
<h1>Relationships<a class="headerlink" href="#relationships" title="Permalink to this headline">¶</a></h1>
<div class="section" id="serial-one-to-one-relationship">
<h2>Serial: one to one relationship<a class="headerlink" href="#serial-one-to-one-relationship" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>All commads in &#8216;job1&#8217; are submitted, and those is &#8216;jobs2&#8217; <em>wait</em> for
those in &#8216;job1&#8217; to complete.</li>
<li>Commands in &#8216;job2&#8217; are serially dependent on &#8216;job1&#8217;</li>
<li>Both jobs are submitted as parallel (<em>scatter</em>), i.e. there is not
<strong>intra</strong> dependency.</li>
<li>so previous job submission: <code class="docutils literal"><span class="pre">scatter</span></code>, and current job&#8217;s dependency
type <code class="docutils literal"><span class="pre">serial</span></code></li>
</ul>
<div class="code r highlight-python"><div class="highlight"><pre><span class="n">cmds</span> <span class="o">=</span> <span class="n">rep</span><span class="p">(</span><span class="s">&quot;sleep 5&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">jobj1</span> <span class="o">&lt;-</span> <span class="n">job</span><span class="p">(</span><span class="n">q_obj</span><span class="o">=</span><span class="n">qobj</span><span class="p">,</span> <span class="n">cmd</span> <span class="o">=</span> <span class="n">cmds</span><span class="p">,</span> <span class="n">submission_type</span> <span class="o">=</span> <span class="s">&quot;scatter&quot;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;job1&quot;</span><span class="p">)</span>
<span class="n">jobj2</span> <span class="o">&lt;-</span> <span class="n">job</span><span class="p">(</span><span class="n">q_obj</span><span class="o">=</span><span class="n">qobj</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;job2&quot;</span><span class="p">,</span> <span class="n">cmd</span> <span class="o">=</span> <span class="n">cmds</span><span class="p">,</span> <span class="n">submission_type</span> <span class="o">=</span> <span class="s">&quot;scatter&quot;</span><span class="p">,</span>
             <span class="n">dependency_type</span> <span class="o">=</span> <span class="s">&quot;serial&quot;</span><span class="p">,</span> <span class="n">previous_job</span> <span class="o">=</span> <span class="s">&quot;job1&quot;</span><span class="p">)</span>
<span class="n">fobj</span> <span class="o">&lt;-</span> <span class="n">flow</span><span class="p">(</span><span class="n">jobs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">jobj1</span><span class="p">,</span> <span class="n">jobj2</span><span class="p">))</span>
<span class="n">plot_flow</span><span class="p">(</span><span class="n">fobj</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="" src="../../_images/unnamed-chunk-6-1.pdf" />
</div>
</div>
<div class="section" id="gather-many-to-one-relationship">
<h2>Gather: many to one relationship<a class="headerlink" href="#gather-many-to-one-relationship" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>makes sense when previous job had many commands running in parallel
and current job would wait for all</li>
<li>so previous job submission: <code class="docutils literal"><span class="pre">scatter</span></code>, and current job&#8217;s dependency
type <code class="docutils literal"><span class="pre">gather</span></code></li>
</ul>
<div class="code r highlight-python"><div class="highlight"><pre><span class="n">jobj1</span> <span class="o">&lt;-</span> <span class="n">job</span><span class="p">(</span><span class="n">q_obj</span><span class="o">=</span><span class="n">qobj</span><span class="p">,</span> <span class="n">cmd</span> <span class="o">=</span> <span class="n">cmds</span><span class="p">,</span> <span class="n">submission_type</span> <span class="o">=</span> <span class="s">&quot;scatter&quot;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;job1&quot;</span><span class="p">)</span>
<span class="n">jobj2</span> <span class="o">&lt;-</span> <span class="n">job</span><span class="p">(</span><span class="n">q_obj</span><span class="o">=</span><span class="n">qobj</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;job2&quot;</span><span class="p">,</span> <span class="n">cmd</span> <span class="o">=</span> <span class="n">cmds</span><span class="p">,</span> <span class="n">submission_type</span> <span class="o">=</span> <span class="s">&quot;scatter&quot;</span><span class="p">,</span>
             <span class="n">dependency_type</span> <span class="o">=</span> <span class="s">&quot;gather&quot;</span><span class="p">,</span> <span class="n">previous_job</span> <span class="o">=</span> <span class="s">&quot;job1&quot;</span><span class="p">)</span>
<span class="n">fobj</span> <span class="o">&lt;-</span> <span class="n">flow</span><span class="p">(</span><span class="n">jobs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">jobj1</span><span class="p">,</span> <span class="n">jobj2</span><span class="p">))</span>
<span class="n">plot_flow</span><span class="p">(</span><span class="n">fobj</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="" src="../../_images/unnamed-chunk-7-1.pdf" />
</div>
</div>
<div class="section" id="burst-one-to-many-relationship">
<h2>Burst: one to many relationship<a class="headerlink" href="#burst-one-to-many-relationship" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>makes sense when previous job had one command current job would split
and submit several jobs in parallel</li>
<li>so previous job submission_type: <code class="docutils literal"><span class="pre">serial</span></code>, and current job&#8217;s
dependency type <code class="docutils literal"><span class="pre">burst</span></code>, with a submission type: <code class="docutils literal"><span class="pre">scatter</span></code></li>
</ul>
<div class="code r highlight-python"><div class="highlight"><pre><span class="n">jobj1</span> <span class="o">&lt;-</span> <span class="n">job</span><span class="p">(</span><span class="n">q_obj</span><span class="o">=</span><span class="n">qobj</span><span class="p">,</span> <span class="n">cmd</span> <span class="o">=</span> <span class="n">cmds</span><span class="p">,</span> <span class="n">submission_type</span> <span class="o">=</span> <span class="s">&quot;serial&quot;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;job1&quot;</span><span class="p">)</span>
<span class="n">jobj2</span> <span class="o">&lt;-</span> <span class="n">job</span><span class="p">(</span><span class="n">q_obj</span><span class="o">=</span><span class="n">qobj</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;job2&quot;</span><span class="p">,</span> <span class="n">cmd</span> <span class="o">=</span> <span class="n">cmds</span><span class="p">,</span> <span class="n">submission_type</span> <span class="o">=</span> <span class="s">&quot;scatter&quot;</span><span class="p">,</span>
             <span class="n">dependency_type</span> <span class="o">=</span> <span class="s">&quot;burst&quot;</span><span class="p">,</span> <span class="n">previous_job</span> <span class="o">=</span> <span class="s">&quot;job1&quot;</span><span class="p">)</span>
<span class="n">fobj</span> <span class="o">&lt;-</span> <span class="n">flow</span><span class="p">(</span><span class="n">jobs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">jobj1</span><span class="p">,</span> <span class="n">jobj2</span><span class="p">))</span>
<span class="n">plot_flow</span><span class="p">(</span><span class="n">fobj</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="" src="../../_images/unnamed-chunk-8-1.pdf" />
</div>
</div>
</div>
<div class="section" id="hpcc-submission-formats">
<h1>HPCC submission formats<a class="headerlink" href="#hpcc-submission-formats" title="Permalink to this headline">¶</a></h1>
<p><strong>LSF</strong></p>
<div class="code r highlight-python"><div class="highlight"><pre>queue(type = &quot;lsf&quot;)@format
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#&gt; Setting default time to: 72:00. If this is more than queue max (/improper format), job will fail. You may change this in job()</span>
<span class="c">#&gt;</span>
<span class="c">#&gt; Setting default memory to: 10000. If this is more than queue max (/improper format), job will fail.</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#&gt; [1] &quot;${SUBMIT_EXE} -q ${QUEUE} -J ${JOBNAME} -o ${STDOUT} -e ${STDERR} -n ${CPU} -cwd ${CWD} -M ${MEMORY} -R span[ptile=${CPU}] -W ${WALLTIME} -r ${EXTRA_OPTS} ${DEPENDENCY} &#39;&lt;&#39; ${CMD} &quot;</span>
</pre></div>
</div>
<p><strong>torque</strong></p>
<div class="code r highlight-python"><div class="highlight"><pre>queue(type = &quot;torque&quot;)@format
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#&gt; Setting default time to: 72:00:00. If this is more than queue max (/improper format), job will fail. You may change this in job()</span>
<span class="c">#&gt;</span>
<span class="c">#&gt; Setting default memory to: 10g. If this is more than queue max (/improper format), job will fail.</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#&gt; [1] &quot;${SUBMIT_EXE} -N ${JOBNAME} -q ${QUEUE} -l nodes=${NODES}:ppn=${CPU} -l walltime=${WALLTIME} -l mem=${MEMORY} -S /bin/bash -d ${CWD} -V -o ${STDOUT} -m ae -M ${EMAIL} -j oe -r y -V ${EXTRA_OPTS} ${CMD} ${DEPENDENCY}&quot;</span>
</pre></div>
</div>
<p>My HPCC is not supported, how to make it work? send a message to:
sahil.seth [at] me.com</p>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../topics.html" class="btn btn-neutral float-right" title="Help on available functions" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../build.html" class="btn btn-neutral" title="Building Pipelines" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Sahil Seth.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>